[
  {
    "objectID": "assignment1_final.html",
    "href": "assignment1_final.html",
    "title": "Assignment 1: Census Data Quality for Policy Decisions",
    "section": "",
    "text": "library(tidyverse) library(tidycensus) library(knitr)\ncensus_api_key(Sys.getenv(“e195d3b46a99d2c4f9250dbc870202be7aaf8a2b”)) install = TRUE\nmy_state = “New Jersey”\nacs_vars_2022 &lt;- load_variables(2022, “acs5”, cache = TRUE)\nnj_data &lt;- get_acs( geography = “county”, variables = c( total_pop = “B01003_001”, median_income = “B19013_001” ), state = “NJ”, year = 2022, output = “wide”\n)\nhead(nj_data)\nnj_clean &lt;- nj_data %&gt;% mutate( county_name = str_remove(NAME, “, New Jersey”), county_name = str_remove(county_name, ” County”) )\nhead(nj_clean)\nnj_reliability &lt;- nj_clean %&gt;% mutate( moe_percentage = round((median_incomeM / median_incomeE) * 100, 2),\nreliability = case_when(\n  moe_percentage &lt; 5 ~ \"High Confidence\",\n  moe_percentage &gt;= 5 & moe_percentage &lt;= 10 ~ \"Moderate\",\n  moe_percentage &gt; 10 ~ \"Low Confidence\"\n)\n)\ncount(nj_reliability, reliability)\nlibrary(dplyr) library(knitr)\nnj_reliability %&gt;% mutate( moe_pct = 100 * median_incomeM / median_incomeE ) %&gt;% arrange(desc(moe_pct)) %&gt;% slice_head(n = 5) %&gt;% select( county_name, median_income = median_incomeE, margin_of_error = median_incomeM, moe_pct, reliability ) %&gt;% mutate(MOE % = paste0(round(moe_pct, 2), “%”)) %&gt;% select(-moe_pct) %&gt;%\nknitr::kable( caption = “Top 5 NJ Counties with Highest MOE Percentage”, col.names = c(“County”, “Median Income”, “Margin of Error”, “MOE %”, “Reliability Category”) )\nselected_counties &lt;- nj_reliability %&gt;% filter(county_name %in% c( “Somerset”, “Essex”, “Middlesex” )) %&gt;% mutate(moe_pct = 100 * median_incomeM / median_incomeE) %&gt;% select( county_name, median_income = median_incomeE, moe_pct, reliability ) %&gt;% mutate(MOE % = paste0(round(moe_pct, 2), “%”)) %&gt;% select(-moe_pct)\nknitr::kable( selected_counties, caption = “Selected Counties for Tract-Level Study”, col.names = c(“County”, “Median Income”, “MOE %”, “Reliability Category”) )\n\nMiddlesex, where I’m from, has the lowest percentage\nmy_state &lt;- “New Jersey” my_year &lt;- 2022\nrace_vars &lt;- c( total = “B03002_001”, white = “B03002_003”, black = “B03002_004”, hispanic = “B03002_012” )\ntract_demo &lt;- get_acs( geography = “tract”, state = my_state, county = c(“035”,“013”,“023”), year = my_year, variables = race_vars, output = “wide” )\nnj_counties &lt;- tidycensus::fips_codes %&gt;% filter(state_code == “34”) %&gt;% # NJ = 34 distinct(county_code, county) %&gt;% rename(county_name = county)\ntract_demo &lt;- tract_demo %&gt;% mutate(county_code = substr(GEOID, 3, 5)) %&gt;% left_join(nj_counties, by = “county_code”) %&gt;% select(-county_code)\ntract_demo &lt;- tract_demo %&gt;% mutate( pct_white = if_else(totalE &gt; 0, 100 * whiteE / totalE, NA_real_), pct_black = if_else(totalE &gt; 0, 100 * blackE / totalE, NA_real_), pct_hispanic = if_else(totalE &gt; 0, 100 * hispanicE / totalE, NA_real_) )\ntop_hispanic_tract &lt;- tract_demo %&gt;% filter(!is.na(pct_hispanic)) %&gt;% arrange(desc(pct_hispanic)) %&gt;% slice_head(n = 1) %&gt;% select(NAME, pct_hispanic) %&gt;% mutate(Hispanic % = sprintf(“%.2f%%”, pct_hispanic))\nknitr::kable( top_hispanic_tract, caption = “Tract with Highest Percent Hispanic/Latino (Selected NJ Counties)”, col.names = c(“Tract”, “County”, “Hispanic %”) )\ncounty_avgs &lt;- tract_demo %&gt;% group_by(county_name) %&gt;% summarise( n_tracts = n(), avg_white = mean(pct_white, na.rm = TRUE), avg_black = mean(pct_black, na.rm = TRUE), avg_hispanic = mean(pct_hispanic, na.rm = TRUE), .groups = “drop” ) %&gt;% arrange(desc(avg_hispanic))\ncounty_avgs_fmt &lt;- county_avgs %&gt;% mutate( Avg White % = sprintf(“%.2f%%”, avg_white), Avg Black % = sprintf(“%.2f%%”, avg_black), Avg Hispanic % = sprintf(“%.2f%%”, avg_hispanic) ) %&gt;% select(county_name, n_tracts, Avg White %, Avg Black %, Avg Hispanic %)\nknitr::kable( county_avgs_fmt, caption = “Average Tract Demographics by County (Percent of Total Population)”, col.names = c(“County”, “# Tracts”, “Avg White %”, “Avg Black %”, “Avg Hispanic %”) )\ndemographic_moe &lt;- tract_demo %&gt;% mutate( white_moe_pct = if_else(whiteE &gt; 0, 100 * whiteM / whiteE, NA_real_), black_moe_pct = if_else(blackE &gt; 0, 100 * blackM / blackE, NA_real_), hispanic_moe_pct = if_else(hispanicE &gt; 0, 100 * hispanicM / hispanicE, NA_real_), high_moe_flag = (white_moe_pct &gt; 15) | (black_moe_pct &gt; 15) | (hispanic_moe_pct &gt; 15) )\ndemographic_moe &lt;- tract_demo %&gt;% mutate( white_moe_pct = if_else(whiteE &gt; 0, 100 * whiteM / whiteE, NA_real_), black_moe_pct = if_else(blackE &gt; 0, 100 * blackM / blackE, NA_real_), hispanic_moe_pct = if_else(hispanicE &gt; 0, 100 * hispanicM / hispanicE, NA_real_),\nany_high_moe = pmax(white_moe_pct, black_moe_pct, hispanic_moe_pct, na.rm = TRUE) &gt; 15\n)\noverall_moe_summary &lt;- demographic_moe %&gt;% summarise( total_tracts = n(), tracts_high_moe = sum(any_high_moe, na.rm = TRUE), pct_high_moe = 100 * tracts_high_moe / total_tracts, avg_white_moe = mean(white_moe_pct, na.rm = TRUE), avg_black_moe = mean(black_moe_pct, na.rm = TRUE), avg_hispanic_moe = mean(hispanic_moe_pct, na.rm = TRUE) )\nknitr::kable( overall_moe_summary, caption = “Overall MOE Summary (Tract-Level)”, col.names = c(“Total Tracts”, “Tracts with High MOE (&gt;15%)”, “% High MOE”, “Avg White MOE %”, “Avg Black MOE %”, “Avg Hispanic MOE %”) )\nby_county_moe_summary &lt;- demographic_moe %&gt;% group_by(county_name) %&gt;% summarise( n_tracts = n(), tracts_high_moe = sum(any_high_moe, na.rm = TRUE), pct_high_moe = 100 * tracts_high_moe / n_tracts, avg_white_moe = mean(white_moe_pct, na.rm = TRUE), avg_black_moe = mean(black_moe_pct, na.rm = TRUE), avg_hispanic_moe = mean(hispanic_moe_pct, na.rm = TRUE), .groups = “drop” ) %&gt;% arrange(desc(pct_high_moe))\nknitr::kable( by_county_moe_summary, caption = “MOE Summary by County (Tract-Level)”, col.names = c(“County”, “# Tracts”, “# High MOE Tracts”, “% High MOE”, “Avg White MOE %”, “Avg Black MOE %”, “Avg Hispanic MOE %”) )\npattern_summary &lt;- demographic_moe %&gt;% group_by(any_high_moe) %&gt;%\nsummarise( n_tracts = n(), avg_population = mean(totalE, na.rm = TRUE), avg_white_pct = mean(pct_white, na.rm = TRUE), avg_black_pct = mean(pct_black, na.rm = TRUE), avg_hisp_pct = mean(pct_hispanic, na.rm = TRUE), .groups = “drop” ) %&gt;% mutate( group = if_else(any_high_moe, “High MOE (≥15% in any group)”, “Low MOE (&lt;15%)”) ) %&gt;% select(group, n_tracts, avg_population, avg_white_pct, avg_black_pct, avg_hisp_pct)\nknitr::kable( pattern_summary, caption = “Comparison of Tracts by Data Quality (High vs. Low MOE)”, col.names = c(“MOE Group”, “Number of Tracts”, “Avg Population”, “Avg White %”, “Avg Black %”, “Avg Hispanic %”), format.args = list(big.mark = “,”, digits = 2) )"
  }
]